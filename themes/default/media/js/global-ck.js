function submitForm(e){$(e).removeAttr("onclick");var t=$(e).parents("form:first");$("input:submit",t).attr("disabled","disabled");setTimeout(function(){t.submit()},500)}function submitAjax(e){var t=$(e).parents("form:first");t.submit()}function flashMessage(e,t){var n="<ul>";n+=t;n+="</ul>";e.html(n).fadeIn("fast").fadeOut(4e3).html()}function showConfirmationMessage(e){var t=$("#confirmation-container"),n='<div class="modal-window"><article class="modal base"><p>'+e+"</p>"+"</article></div>";$("div.modal-window",t).replaceWith(n);t.fadeIn("fast").addClass("visible");t.delay(1250).fadeOut("fast").removeClass("visible")}function showDefaultAvatar(e){e.onerror="";e.src=window.default_avatar_url;return!0}function scrollToBuoy(){$.getScript("/themes/default/media/js/jquery.scrollto.js",function(){$.scrollTo($("#buoy"),{duration:300,axis:"y",easing:"linear",offset:-100});$("#buoy").prepend("<div class='buoy-message base'><p>Here's where you left off.</p></div>");$("#buoy .buoy-message").fadeIn("fast");$("#buoy .buoy-message").delay(2e3).fadeOut("slow")})}$(document).ready(function(){function e(){$(".popover-window").bind("clickoutside",function(e){$(this).fadeOut("fast").unbind()})}function t(e,t){this.modal=t==undefined?!1:t;this.container=this.modal?$("#modal-container"):$("#zoom-container");this.contents=e;this.dialogBox=$("div.modal-window",this.container)}function n(e,t,n,r){r||(r=this);$.get(e,function(e){var i=$(e);i.hasClass(t)||(i=$(e).find("."+t));n.call(r,i)})}function o(){if($(".save-toolbar").length>0){$("select").change(function(){$(this).closest("section.property-parameters, .modal-body form").find(".save-toolbar").fadeIn("fast")});$("input, textarea").keypress(function(){$(this).closest("section.property-parameters, .modal-body form").find(".save-toolbar").fadeIn("fast")});$(":radio, :checkbox").click(function(){$(this).closest("section.property-parameters, .modal-body form").find(".save-toolbar").fadeIn("fast")});$(".save-toolbar .cancel a").live("click",function(e){$(this).closest(".save-toolbar").fadeOut("fast");e.preventDefault()})}}$("a.popover-trigger").live("click",function(t){$(this).closest(".popover").toggleClass("active");$(this).closest(".popover").find(".popover-window").fadeToggle("fast");e();return!1});t.prototype.hide=function(){if(!this.modal&&$("body").hasClass("has_modal"))return;this.container.fadeOut("slow");this.modal?$("body").removeClass("has_modal"):$("body").removeClass("zoomed");!$("body").hasClass("zoomed")&&!$("body").hasClass("has_modal")&&$("body").removeClass("noscroll");this.dialogBox.unbind();return this};t.prototype._registerHide=function(){var e=this;this.dialogBox.bind("clickoutside",function(t){e.hide();return!1});var t=function(n){if(n.keyCode==27){e.hide()&&$(window).unbind("keypress",t);return!1}};$(window).bind("keypress",t);return this};t.prototype.show=function(){this.dialogBox.html(this.contents);this.container.fadeIn(350);o();$("body").addClass("noscroll");this._registerHide();this.modal?$("body").addClass("has_modal"):$("body").addClass("zoomed");return this};var r=null;window.modalHide=function(){r&&r.hide()};window.modalShow=function(e){r=(new t(e,!0)).show()};$("a.modal-trigger").live("click",function(){n($(this).attr("href"),"modal",modalShow);return!1});$("article.modal .close a").live("click",function(e){r.hide();return!1});var i=null;window.zoomHide=function(){i&&i.hide()};window.zoomShow=function(e){i=(new t(e)).show()};$("a.zoom-trigger").live("click",function(){n($(this).attr("href"),"modal",zoomShow);return!1});$("#zoom-container .close a").live("click",function(){zoomHide();return!1});var s=function(e,t){var n=$(e).data("title");if(n!=undefined){var r=$(e).closest("div.parameter").find("h2").html();r==null&&(r="");container=$("#confirmation-container");var i='<div class="modal-window"><article class="modal base"><p>You are '+n+" "+r+"</p>"+"</article>"+"</div>";$("div.modal-window",container).replaceWith(i);container.fadeIn("fast").addClass("visible");container.delay(1e3).fadeOut("fast").removeClass("visible");t.stopPropagation()}};$(".follow a").live("click",function(e){s(this,e)});$(".remove a").live("click",function(e){var t=$(this).attr("href");$(t).fadeOut("fast").remove();$(this).parent().fadeOut("fast").remove();e.preventDefault()});o();window.innerWidth>800&&$("article.drop").hover(function(){$(this).find(".remove").fadeIn("fast")},function(){$(this).find(".remove").fadeOut("fast")});$("section.meta-data h3").live("click",function(e){$(this).toggleClass("open").siblings("div.meta-data-content").slideToggle("fast")});$("#buoy").length>0&&scrollToBuoy();$("input[type=password]").keypress(function(e){if(e.which==13){$(this).parents("form:first").submit();e.preventDefault()}});if(typeof logged_in_account!="undefined"){$("header .user-menu .bucket a").live("click",function(){modalShow((new Assets.HeaderBucketsModal({collection:Assets.bucketList})).render().el);return!1});$("header .user-menu .rivers a").live("click",function(){modalShow((new Assets.HeaderRiversModal({collection:Assets.riverList})).render().el);return!1})}$("#confirm-window-template").length&&(window.ConfirmationWindow=Backbone.View.extend({tagName:"article",className:"modal",template:_.template($("#confirm-window-template").html()),events:{"click .button-blue a":"confirm"},constructor:function(e,t,n){Backbone.View.prototype.constructor.apply(this,arguments);this.message=e;this.callback=t;this.context=n},show:function(){modalShow(this.render().el)},render:function(){this.$el.html(this.template({message:this.message}));return this},confirm:function(){modalHide();this.callback.call(this.context);return!1}}));$("#feedback-modal-template").length&&(window.FeedbackWindow=Backbone.View.extend({className:"modal",template:_.template($("#feedback-modal-template").html()),events:{"click .close a":"close"},show:function(){modalShow(this.render().el)},render:function(){this.$el.html(this.template({message:this.message}));return this},close:function(){r.hide()}}));$("footer a.btn-feedback").live("click",function(){modalShow((new FeedbackWindow).render().el);return!1})});window.addEventListener("load",function(){setTimeout(function(){window.scrollTo(0,1)},0)});